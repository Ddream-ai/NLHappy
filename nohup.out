[[36m2022-06-01 16:52:26,486[0m][[34mnlhappy.utils.utils[0m][[32mINFO[0m] - Disabling python warnings! <config.ignore_warnings=True>[0m
CONFIG
├── trainer
│   └── _target_: pytorch_lightning.Trainer                                     
│       gpus: 2                                                                 
│       precision: 16                                                           
│       min_epochs: 2                                                           
│       max_epochs: 20                                                          
│       profiler: simple                                                        
│       progress_bar_refresh_rate: 5                                            
│       weights_summary: full                                                   
│       logger: true                                                            
│       num_sanity_val_steps: 0                                                 
│       stochastic_weight_avg: false                                            
│       accumulate_grad_batches: 1                                              
│       resume_from_checkpoint: null                                            
│       strategy: ddp                                                           
│       sync_batchnorm: true                                                    
│                                                                               
├── model
│   └── _target_: nlhappy.models.BertGlobalPointer                              
│       lr: 2.0e-05                                                             
│       dropout: 0.2                                                            
│       hidden_size: 256                                                        
│       weight_decay: 0.01                                                      
│       adv: ''                                                                 
│                                                                               
├── datamodule
│   └── _target_: nlhappy.datamodules.SpanClassificationDataModule              
│       dataset: CMeEE                                                          
│       max_length: 420                                                         
│       batch_size: 14                                                          
│       plm: chinese-macbert-base                                               
│       pin_memory: true                                                        
│       num_workers: 2                                                          
│       dataset_dir: /root/nlhappy/datasets/                                    
│       plm_dir: /root/nlhappy/plms/                                            
│                                                                               
├── callbacks
│   └── model_checkpoint:                                                       
│         _target_: pytorch_lightning.callbacks.ModelCheckpoint                 
│         monitor: val/f1                                                       
│         mode: max                                                             
│         save_top_k: 1                                                         
│         save_last: false                                                      
│         verbose: false                                                        
│         dirpath: checkpoints/                                                 
│         filename: epoch{epoch:02d}_{val/f1:.3f}                               
│         auto_insert_metric_name: false                                        
│       early_stopping:                                                         
│         _target_: pytorch_lightning.callbacks.EarlyStopping                   
│         monitor: val/f1                                                       
│         mode: max                                                             
│         patience: 3                                                           
│         min_delta: 0                                                          
│       model_summary:                                                          
│         _target_: pytorch_lightning.callbacks.RichModelSummary                
│         max_depth: 1                                                          
│       rich_progress_bar:                                                      
│         _target_: pytorch_lightning.callbacks.RichProgressBar                 
│                                                                               
├── logger
│   └── None                                                                    
├── test_after_training
│   └── False                                                                   
├── seed
│   └── 2222                                                                    
└── name
    └── CMeEE                                                                   
Global seed set to 2222
[[36m2022-06-01 16:52:26,576[0m][[34mnlhappy.run[0m][[32mINFO[0m] - Instantiating datamodule <nlhappy.datamodules.SpanClassificationDataModule>[0m
[[36m2022-06-01 16:52:28,779[0m][[34mnlhappy.run[0m][[32mINFO[0m] - Instantiating model <nlhappy.models.BertGlobalPointer>[0m
[[36m2022-06-01 16:52:35,325[0m][[34mtorch.distributed.nn.jit.instantiator[0m][[32mINFO[0m] - Created a temporary directory at /tmp/tmpbanapkai[0m
[[36m2022-06-01 16:52:35,326[0m][[34mtorch.distributed.nn.jit.instantiator[0m][[32mINFO[0m] - Writing /tmp/tmpbanapkai/_remote_module_non_sriptable.py[0m
[[36m2022-06-01 16:52:38,673[0m][[34mnlhappy.run[0m][[32mINFO[0m] - Instantiating callback <pytorch_lightning.callbacks.ModelCheckpoint>[0m
[[36m2022-06-01 16:52:38,678[0m][[34mnlhappy.run[0m][[32mINFO[0m] - Instantiating callback <pytorch_lightning.callbacks.EarlyStopping>[0m
[[36m2022-06-01 16:52:38,680[0m][[34mnlhappy.run[0m][[32mINFO[0m] - Instantiating callback <pytorch_lightning.callbacks.RichModelSummary>[0m
[[36m2022-06-01 16:52:38,681[0m][[34mnlhappy.run[0m][[32mINFO[0m] - Instantiating callback <pytorch_lightning.callbacks.RichProgressBar>[0m
[[36m2022-06-01 16:52:38,681[0m][[34mnlhappy.run[0m][[32mINFO[0m] - Instantiating trainer <pytorch_lightning.Trainer>[0m
Using 16bit native Automatic Mixed Precision (AMP)
Trainer already configured with model summary callbacks: [<class 'pytorch_lightning.callbacks.rich_model_summary.RichModelSummary'>]. Skipping setting a default `ModelSummary` callback.
GPU available: True, used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
[[36m2022-06-01 16:52:38,724[0m][[34mnlhappy.run[0m][[32mINFO[0m] - Logging hyperparameters![0m
[[36m2022-06-01 16:52:38,724[0m][[34mnlhappy.run[0m][[32mINFO[0m] - Starting training![0m
Global seed set to 2222
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/2
Global seed set to 2222
[[36m2022-06-01 16:52:53,445[0m][[34mtorch.distributed.nn.jit.instantiator[0m][[32mINFO[0m] - Created a temporary directory at /tmp/tmpoxi0in2y[0m
[[36m2022-06-01 16:52:53,446[0m][[34mtorch.distributed.nn.jit.instantiator[0m][[32mINFO[0m] - Writing /tmp/tmpoxi0in2y/_remote_module_non_sriptable.py[0m
Global seed set to 2222
Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/2
[[36m2022-06-01 16:52:57,278[0m][[34mtorch.distributed.distributed_c10d[0m][[32mINFO[0m] - Added key: store_based_barrier_key:1 to store for rank: 1[0m
[[36m2022-06-01 16:52:57,281[0m][[34mtorch.distributed.distributed_c10d[0m][[32mINFO[0m] - Added key: store_based_barrier_key:1 to store for rank: 0[0m
[[36m2022-06-01 16:52:57,283[0m][[34mtorch.distributed.distributed_c10d[0m][[32mINFO[0m] - Rank 0: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.[0m
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 2 processes
----------------------------------------------------------------------------------------------------

[[36m2022-06-01 16:52:57,288[0m][[34mtorch.distributed.distributed_c10d[0m][[32mINFO[0m] - Rank 1: Completed store-based barrier for key:store_based_barrier_key:1 with 2 nodes.[0m
LOCAL_RANK: 1 - CUDA_VISIBLE_DEVICES: [0,1]
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0,1]
┏━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━┓
┃   ┃ Name         ┃ Type                              ┃ Params ┃
┡━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━┩
│ 0 │ bert         │ BertModel                         │  102 M │
│ 1 │ classifier   │ EfficientGlobalPointer            │  402 K │
│ 2 │ dropout      │ Dropout                           │      0 │
│ 3 │ criterion    │ MultiLabelCategoricalCrossEntropy │      0 │
│ 4 │ train_metric │ SpanF1                            │      0 │
│ 5 │ val_metric   │ SpanF1                            │      0 │
│ 6 │ test_metric  │ SpanF1                            │      0 │
└───┴──────────────┴───────────────────────────────────┴────────┘
Trainable params: 102 M                                                         
Non-trainable params: 0                                                         
Total params: 102 M                                                             
Total estimated model params size (MB): 205                                     
Epoch 15  ━━━━━━━━━━━━━━━━ 1012/1012 0:07:10 •        5.62it/s train/f1_step:   
                                     0:00:00                   0.639 train_loss:
                                                               0.453 val/f1:    
                                                               0.643            
                                                               train/f1_epoch:  
                                                               0.735            
FIT Profiler Report

--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Action                                                                                                                                                                                                        	|  Mean duration (s)	|  Num calls      	|  Total time (s) 	|  Percentage %   	|
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  Total                                                                                                                                                                                                         	|  -              	|  538082         	|  6977.9         	|  100 %          	|
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
|  run_training_epoch                                                                                                                                                                                            	|  430.93         	|  16             	|  6894.9         	|  98.81          	|
|  run_training_batch                                                                                                                                                                                            	|  0.50278        	|  12080          	|  6073.6         	|  87.04          	|
|  [Strategy]DDPStrategy.training_step                                                                                                                                                                           	|  0.50198        	|  12080          	|  6063.9         	|  86.901         	|
|  [Strategy]DDPStrategy.validation_step                                                                                                                                                                         	|  0.17486        	|  4112           	|  719.02         	|  10.304         	|
|  optimizer_step                                                                                                                                                                                                	|  0.042072       	|  12080          	|  508.23         	|  7.2834         	|
|  on_train_batch_end                                                                                                                                                                                            	|  0.0031241      	|  12080          	|  37.739         	|  0.54083        	|
|  [Callback]ModelCheckpoint{'monitor': 'val/f1', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_train_epoch_end                 	|  2.0224         	|  16             	|  32.359         	|  0.46373        	|
|  [Callback]RichProgressBar.on_validation_batch_end                                                                                                                                                             	|  0.0020063      	|  4112           	|  8.2498         	|  0.11823        	|
|  [Strategy]DDPStrategy.batch_to_device                                                                                                                                                                         	|  0.00034955     	|  16192          	|  5.66           	|  0.081112       	|
|  on_train_batch_start                                                                                                                                                                                          	|  0.0003519      	|  12080          	|  4.2509         	|  0.06092        	|
|  [LightningModule]BertGlobalPointer.on_train_start                                                                                                                                                             	|  0.36224        	|  1              	|  0.36224        	|  0.0051912      	|
|  [Callback]EarlyStopping{'monitor': 'val/f1', 'mode': 'max'}.on_after_backward                                                                                                                                 	|  2.9662e-05     	|  12080          	|  0.35832        	|  0.0051351      	|
|  [Callback]EarlyStopping{'monitor': 'val/f1', 'mode': 'max'}.on_before_optimizer_step                                                                                                                          	|  2.3882e-05     	|  12080          	|  0.2885         	|  0.0041344      	|
|  [Callback]RichModelSummary.on_after_backward                                                                                                                                                                  	|  2.1517e-05     	|  12080          	|  0.25992        	|  0.0037249      	|
|  [Callback]GradientAccumulationScheduler.on_after_backward                                                                                                                                                     	|  2.0886e-05     	|  12080          	|  0.2523         	|  0.0036157      	|
|  [Callback]RichModelSummary.on_before_optimizer_step                                                                                                                                                           	|  2.0837e-05     	|  12080          	|  0.25171        	|  0.0036072      	|
|  [Callback]ModelCheckpoint{'monitor': 'val/f1', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_after_backward                  	|  2.0463e-05     	|  12080          	|  0.24719        	|  0.0035424      	|
|  [Callback]ModelCheckpoint{'monitor': 'val/f1', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_before_optimizer_step           	|  2.0294e-05     	|  12080          	|  0.24515        	|  0.0035133      	|
|  [Callback]GradientAccumulationScheduler.on_before_optimizer_step                                                                                                                                              	|  2.0272e-05     	|  12080          	|  0.24488        	|  0.0035094      	|
|  [Callback]RichProgressBar.on_after_backward                                                                                                                                                                   	|  2.0047e-05     	|  12080          	|  0.24217        	|  0.0034705      	|
|  [Callback]RichProgressBar.on_before_optimizer_step                                                                                                                                                            	|  1.9934e-05     	|  12080          	|  0.24081        	|  0.003451       	|
|  [Callback]EarlyStopping{'monitor': 'val/f1', 'mode': 'max'}.on_before_backward                                                                                                                                	|  1.8274e-05     	|  12080          	|  0.22075        	|  0.0031636      	|
|  [Callback]EarlyStopping{'monitor': 'val/f1', 'mode': 'max'}.on_batch_start                                                                                                                                    	|  1.4318e-05     	|  12080          	|  0.17297        	|  0.0024787      	|
|  [Callback]ModelCheckpoint{'monitor': 'val/f1', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_batch_start                     	|  1.3883e-05     	|  12080          	|  0.16771        	|  0.0024034      	|
|  [Callback]EarlyStopping{'monitor': 'val/f1', 'mode': 'max'}.on_batch_end                                                                                                                                      	|  1.3015e-05     	|  12080          	|  0.15722        	|  0.0022531      	|
|  [Callback]RichProgressBar.on_before_backward                                                                                                                                                                  	|  1.2559e-05     	|  12080          	|  0.15171        	|  0.0021742      	|
|  [Callback]RichModelSummary.on_batch_start                                                                                                                                                                     	|  1.2521e-05     	|  12080          	|  0.15125        	|  0.0021675      	|
|  [Callback]RichModelSummary.on_before_backward                                                                                                                                                                 	|  1.2402e-05     	|  12080          	|  0.14982        	|  0.002147       	|
|  [Callback]GradientAccumulationScheduler.on_batch_start                                                                                                                                                        	|  1.234e-05      	|  12080          	|  0.14906        	|  0.0021362      	|
|  [Callback]RichProgressBar.on_batch_start                                                                                                                                                                      	|  1.2325e-05     	|  12080          	|  0.14889        	|  0.0021337      	|
|  [Callback]ModelCheckpoint{'monitor': 'val/f1', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_before_backward                 	|  1.2175e-05     	|  12080          	|  0.14707        	|  0.0021077      	|
|  [Callback]GradientAccumulationScheduler.on_before_backward                                                                                                                                                    	|  1.1919e-05     	|  12080          	|  0.14398        	|  0.0020633      	|
|  [Callback]RichModelSummary.on_batch_end                                                                                                                                                                       	|  1.1644e-05     	|  12080          	|  0.14066        	|  0.0020157      	|
|  [Callback]ModelCheckpoint{'monitor': 'val/f1', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_batch_end                       	|  1.1558e-05     	|  12080          	|  0.13963        	|  0.002001       	|
|  [Callback]RichProgressBar.on_validation_batch_start                                                                                                                                                           	|  3.3398e-05     	|  4112           	|  0.13733        	|  0.0019681      	|
|  [Callback]GradientAccumulationScheduler.on_batch_end                                                                                                                                                          	|  1.1245e-05     	|  12080          	|  0.13584        	|  0.0019467      	|
|  [Callback]RichProgressBar.on_batch_end                                                                                                                                                                        	|  1.1165e-05     	|  12080          	|  0.13487        	|  0.0019328      	|
|  [Callback]GradientAccumulationScheduler.on_validation_batch_end                                                                                                                                               	|  2.4539e-05     	|  4112           	|  0.1009         	|  0.001446       	|
|  [LightningModule]BertGlobalPointer.on_validation_model_eval                                                                                                                                                   	|  0.0048623      	|  16             	|  0.077796       	|  0.0011149      	|
|  [Callback]EarlyStopping{'monitor': 'val/f1', 'mode': 'max'}.on_validation_batch_start                                                                                                                         	|  1.5926e-05     	|  4112           	|  0.065488       	|  0.00093851     	|
|  [Callback]EarlyStopping{'monitor': 'val/f1', 'mode': 'max'}.on_validation_batch_end                                                                                                                           	|  1.4494e-05     	|  4112           	|  0.059597       	|  0.00085408     	|
|  [Callback]GradientAccumulationScheduler.on_validation_batch_start                                                                                                                                             	|  1.3954e-05     	|  4112           	|  0.057378       	|  0.00082228     	|
|  [Callback]ModelCheckpoint{'monitor': 'val/f1', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_validation_batch_end            	|  1.3952e-05     	|  4112           	|  0.05737        	|  0.00082216     	|
|  [Callback]RichModelSummary.on_validation_batch_start                                                                                                                                                          	|  1.3279e-05     	|  4112           	|  0.054605       	|  0.00078254     	|
|  [Callback]ModelCheckpoint{'monitor': 'val/f1', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_validation_batch_start          	|  1.3193e-05     	|  4112           	|  0.054251       	|  0.00077746     	|
|  [LightningModule]BertGlobalPointer.on_after_backward                                                                                                                                                          	|  4.3291e-06     	|  12080          	|  0.052295       	|  0.00074944     	|
|  [Callback]RichModelSummary.on_validation_batch_end                                                                                                                                                            	|  1.2236e-05     	|  4112           	|  0.050313       	|  0.00072103     	|
|  [LightningModule]BertGlobalPointer.on_validation_model_train                                                                                                                                                  	|  0.002677       	|  16             	|  0.042832       	|  0.00061382     	|
|  [LightningModule]BertGlobalPointer.on_before_optimizer_step                                                                                                                                                   	|  3.4501e-06     	|  12080          	|  0.041677       	|  0.00059727     	|
|  [Callback]EarlyStopping{'monitor': 'val/f1', 'mode': 'max'}.on_train_epoch_end                                                                                                                                	|  0.002448       	|  16             	|  0.039169       	|  0.00056132     	|
|  [LightningModule]BertGlobalPointer.on_train_batch_end                                                                                                                                                         	|  2.7547e-06     	|  12080          	|  0.033276       	|  0.00047688     	|
|  [LightningModule]BertGlobalPointer.on_train_batch_start                                                                                                                                                       	|  2.5304e-06     	|  12080          	|  0.030567       	|  0.00043805     	|
|  [LightningModule]BertGlobalPointer.on_before_backward                                                                                                                                                         	|  2.5105e-06     	|  12080          	|  0.030327       	|  0.00043462     	|
|  [Strategy]DDPStrategy.on_train_batch_start                                                                                                                                                                    	|  2.4175e-06     	|  12080          	|  0.029204       	|  0.00041852     	|
|  [Callback]RichModelSummary.on_fit_start                                                                                                                                                                       	|  0.028817       	|  1              	|  0.028817       	|  0.00041297     	|
|  [Strategy]DDPStrategy.training_step_end                                                                                                                                                                       	|  2.3302e-06     	|  12080          	|  0.028149       	|  0.00040339     	|
|  [LightningModule]BertGlobalPointer.training_step_end                                                                                                                                                          	|  2.3249e-06     	|  12080          	|  0.028085       	|  0.00040248     	|
|  [Callback]RichProgressBar.on_train_epoch_start                                                                                                                                                                	|  0.0010315      	|  16             	|  0.016504       	|  0.00023651     	|
|  [LightningModule]BertGlobalPointer.on_validation_batch_end                                                                                                                                                    	|  3.1733e-06     	|  4112           	|  0.013049       	|  0.000187       	|
|  [LightningModule]BertGlobalPointer.validation_step_end                                                                                                                                                        	|  3.0551e-06     	|  4112           	|  0.012562       	|  0.00018003     	|
|  [Callback]RichProgressBar.teardown                                                                                                                                                                            	|  0.010681       	|  1              	|  0.010681       	|  0.00015307     	|
|  [LightningModule]BertGlobalPointer.on_validation_batch_start                                                                                                                                                  	|  2.5189e-06     	|  4112           	|  0.010358       	|  0.00014843     	|
|  [Strategy]DDPStrategy.validation_step_end                                                                                                                                                                     	|  2.1082e-06     	|  4112           	|  0.0086688      	|  0.00012423     	|
|  [Callback]RichProgressBar.on_validation_epoch_end                                                                                                                                                             	|  0.0004298      	|  16             	|  0.0068768      	|  9.8551e-05     	|
|  [LightningModule]BertGlobalPointer.configure_optimizers                                                                                                                                                       	|  0.003593       	|  1              	|  0.003593       	|  5.1491e-05     	|
|  [Callback]RichProgressBar.on_validation_end                                                                                                                                                                   	|  0.00021723     	|  16             	|  0.0034756      	|  4.9809e-05     	|
|  [Callback]RichProgressBar.on_train_epoch_end                                                                                                                                                                  	|  0.00012282     	|  16             	|  0.0019651      	|  2.8162e-05     	|
|  [Callback]ModelCheckpoint{'monitor': 'val/f1', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_validation_end                  	|  9.7256e-05     	|  16             	|  0.0015561      	|  2.23e-05       	|
|  [Callback]RichProgressBar.on_train_start                                                                                                                                                                      	|  0.00083168     	|  1              	|  0.00083168     	|  1.1919e-05     	|
|  [Callback]EarlyStopping{'monitor': 'val/f1', 'mode': 'max'}.on_epoch_start                                                                                                                                    	|  1.5218e-05     	|  32             	|  0.00048699     	|  6.979e-06      	|
|  [Callback]RichModelSummary.on_epoch_start                                                                                                                                                                     	|  1.2634e-05     	|  32             	|  0.0004043      	|  5.794e-06      	|
|  [Callback]EarlyStopping{'monitor': 'val/f1', 'mode': 'max'}.on_epoch_end                                                                                                                                      	|  1.2362e-05     	|  32             	|  0.00039558     	|  5.669e-06      	|
|  [Callback]GradientAccumulationScheduler.on_train_epoch_start                                                                                                                                                  	|  2.4388e-05     	|  16             	|  0.0003902      	|  5.592e-06      	|
|  [Callback]ModelCheckpoint{'monitor': 'val/f1', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_epoch_start                     	|  1.1957e-05     	|  32             	|  0.00038264     	|  5.4835e-06     	|
|  [Callback]RichProgressBar.on_epoch_start                                                                                                                                                                      	|  1.177e-05      	|  32             	|  0.00037664     	|  5.3976e-06     	|
|  [Callback]GradientAccumulationScheduler.on_epoch_start                                                                                                                                                        	|  1.1663e-05     	|  32             	|  0.00037322     	|  5.3485e-06     	|
|  [Callback]RichModelSummary.on_train_epoch_end                                                                                                                                                                 	|  2.322e-05      	|  16             	|  0.00037152     	|  5.3243e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val/f1', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_epoch_end                       	|  1.1502e-05     	|  32             	|  0.00036807     	|  5.2747e-06     	|
|  [Callback]GradientAccumulationScheduler.on_epoch_end                                                                                                                                                          	|  1.1174e-05     	|  32             	|  0.00035758     	|  5.1244e-06     	|
|  [Callback]RichModelSummary.on_epoch_end                                                                                                                                                                       	|  1.1066e-05     	|  32             	|  0.00035412     	|  5.0748e-06     	|
|  [Callback]RichProgressBar.on_epoch_end                                                                                                                                                                        	|  1.0612e-05     	|  32             	|  0.00033959     	|  4.8666e-06     	|
|  [Callback]RichProgressBar.on_validation_start                                                                                                                                                                 	|  2.0946e-05     	|  16             	|  0.00033514     	|  4.8028e-06     	|
|  [Callback]GradientAccumulationScheduler.on_validation_epoch_end                                                                                                                                               	|  1.7319e-05     	|  16             	|  0.00027711     	|  3.9713e-06     	|
|  [Callback]EarlyStopping{'monitor': 'val/f1', 'mode': 'max'}.on_validation_start                                                                                                                               	|  1.7e-05        	|  16             	|  0.000272       	|  3.898e-06      	|
|  [LightningModule]BertGlobalPointer.on_validation_start                                                                                                                                                        	|  1.6499e-05     	|  16             	|  0.00026399     	|  3.7832e-06     	|
|  [Callback]EarlyStopping{'monitor': 'val/f1', 'mode': 'max'}.on_validation_epoch_end                                                                                                                           	|  1.6003e-05     	|  16             	|  0.00025605     	|  3.6694e-06     	|
|  [Callback]EarlyStopping{'monitor': 'val/f1', 'mode': 'max'}.on_validation_end                                                                                                                                 	|  1.5728e-05     	|  16             	|  0.00025164     	|  3.6062e-06     	|
|  [Callback]GradientAccumulationScheduler.on_validation_end                                                                                                                                                     	|  1.4748e-05     	|  16             	|  0.00023597     	|  3.3817e-06     	|
|  [Callback]GradientAccumulationScheduler.on_validation_epoch_start                                                                                                                                             	|  1.4689e-05     	|  16             	|  0.00023502     	|  3.3681e-06     	|
|  [Callback]RichModelSummary.on_validation_epoch_start                                                                                                                                                          	|  1.4485e-05     	|  16             	|  0.00023175     	|  3.3212e-06     	|
|  [Callback]RichModelSummary.on_validation_start                                                                                                                                                                	|  1.4195e-05     	|  16             	|  0.00022712     	|  3.2548e-06     	|
|  [Callback]EarlyStopping{'monitor': 'val/f1', 'mode': 'max'}.on_validation_epoch_start                                                                                                                         	|  1.4131e-05     	|  16             	|  0.0002261      	|  3.2402e-06     	|
|  [Callback]GradientAccumulationScheduler.on_train_epoch_end                                                                                                                                                    	|  1.4082e-05     	|  16             	|  0.00022532     	|  3.229e-06      	|
|  [Callback]ModelCheckpoint{'monitor': 'val/f1', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_validation_start                	|  1.3889e-05     	|  16             	|  0.00022223     	|  3.1848e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val/f1', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_validation_epoch_start          	|  1.364e-05      	|  16             	|  0.00021824     	|  3.1276e-06     	|
|  [Callback]GradientAccumulationScheduler.on_validation_start                                                                                                                                                   	|  1.3517e-05     	|  16             	|  0.00021627     	|  3.0993e-06     	|
|  [Callback]RichProgressBar.on_validation_epoch_start                                                                                                                                                           	|  1.3066e-05     	|  16             	|  0.00020906     	|  2.996e-06      	|
|  [Callback]RichModelSummary.on_validation_end                                                                                                                                                                  	|  1.3056e-05     	|  16             	|  0.0002089      	|  2.9938e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val/f1', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_train_epoch_start               	|  1.2039e-05     	|  16             	|  0.00019262     	|  2.7604e-06     	|
|  [Callback]RichModelSummary.on_validation_epoch_end                                                                                                                                                            	|  1.1946e-05     	|  16             	|  0.00019113     	|  2.7391e-06     	|
|  [Callback]EarlyStopping{'monitor': 'val/f1', 'mode': 'max'}.on_train_epoch_start                                                                                                                              	|  1.1876e-05     	|  16             	|  0.00019002     	|  2.7231e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val/f1', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_validation_epoch_end            	|  1.1752e-05     	|  16             	|  0.00018802     	|  2.6946e-06     	|
|  [Callback]RichModelSummary.on_train_epoch_start                                                                                                                                                               	|  1.0468e-05     	|  16             	|  0.00016748     	|  2.4002e-06     	|
|  [LightningModule]BertGlobalPointer.on_validation_end                                                                                                                                                          	|  8.9899e-06     	|  16             	|  0.00014384     	|  2.0613e-06     	|
|  [Callback]EarlyStopping{'monitor': 'val/f1', 'mode': 'max'}.on_save_checkpoint                                                                                                                                	|  1.7197e-05     	|  8              	|  0.00013757     	|  1.9716e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val/f1', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': None}.setup                              	|  0.00012639     	|  1              	|  0.00012639     	|  1.8112e-06     	|
|  [Callback]ModelCheckpoint{'monitor': 'val/f1', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_save_checkpoint                 	|  1.1528e-05     	|  8              	|  9.2225e-05     	|  1.3217e-06     	|
|  [Callback]RichModelSummary.on_save_checkpoint                                                                                                                                                                 	|  1.1306e-05     	|  8              	|  9.0451e-05     	|  1.2962e-06     	|
|  [Callback]RichProgressBar.on_save_checkpoint                                                                                                                                                                  	|  1.0274e-05     	|  8              	|  8.2195e-05     	|  1.1779e-06     	|
|  [Callback]GradientAccumulationScheduler.on_save_checkpoint                                                                                                                                                    	|  9.8959e-06     	|  8              	|  7.9167e-05     	|  1.1345e-06     	|
|  [LightningModule]BertGlobalPointer.on_validation_epoch_end                                                                                                                                                    	|  4.7199e-06     	|  16             	|  7.5519e-05     	|  1.0823e-06     	|
|  [LightningModule]BertGlobalPointer.on_epoch_start                                                                                                                                                             	|  1.9998e-06     	|  32             	|  6.3993e-05     	|  9.1708e-07     	|
|  [LightningModule]BertGlobalPointer.on_epoch_end                                                                                                                                                               	|  1.7731e-06     	|  32             	|  5.6738e-05     	|  8.131e-07      	|
|  [LightningModule]BertGlobalPointer.on_train_epoch_end                                                                                                                                                         	|  3.1771e-06     	|  16             	|  5.0834e-05     	|  7.285e-07      	|
|  [LightningModule]BertGlobalPointer.validation_epoch_end                                                                                                                                                       	|  3.0692e-06     	|  16             	|  4.9107e-05     	|  7.0374e-07     	|
|  [Strategy]DDPStrategy.on_validation_start                                                                                                                                                                     	|  2.8463e-06     	|  16             	|  4.5541e-05     	|  6.5264e-07     	|
|  [LightningModule]BertGlobalPointer.on_train_epoch_start                                                                                                                                                       	|  2.5433e-06     	|  16             	|  4.0693e-05     	|  5.8316e-07     	|
|  [Callback]RichProgressBar.setup                                                                                                                                                                               	|  3.8149e-05     	|  1              	|  3.8149e-05     	|  5.4671e-07     	|
|  [LightningModule]BertGlobalPointer.on_validation_epoch_start                                                                                                                                                  	|  2.3411e-06     	|  16             	|  3.7458e-05     	|  5.368e-07      	|
|  [Callback]RichProgressBar.on_fit_start                                                                                                                                                                        	|  3.6209e-05     	|  1              	|  3.6209e-05     	|  5.1891e-07     	|
|  [Strategy]DDPStrategy.on_validation_end                                                                                                                                                                       	|  1.9107e-06     	|  16             	|  3.0572e-05     	|  4.3812e-07     	|
|  [Callback]EarlyStopping{'monitor': 'val/f1', 'mode': 'max'}.setup                                                                                                                                             	|  2.3239e-05     	|  1              	|  2.3239e-05     	|  3.3304e-07     	|
|  [Callback]EarlyStopping{'monitor': 'val/f1', 'mode': 'max'}.on_fit_start                                                                                                                                      	|  2.2885e-05     	|  1              	|  2.2885e-05     	|  3.2796e-07     	|
|  [Callback]GradientAccumulationScheduler.on_train_start                                                                                                                                                        	|  2.2528e-05     	|  1              	|  2.2528e-05     	|  3.2285e-07     	|
|  [Callback]EarlyStopping{'monitor': 'val/f1', 'mode': 'max'}.on_pretrain_routine_start                                                                                                                         	|  2.1749e-05     	|  1              	|  2.1749e-05     	|  3.1168e-07     	|
|  [Callback]EarlyStopping{'monitor': 'val/f1', 'mode': 'max'}.on_train_start                                                                                                                                    	|  1.9705e-05     	|  1              	|  1.9705e-05     	|  2.8239e-07     	|
|  [Callback]GradientAccumulationScheduler.teardown                                                                                                                                                              	|  1.6722e-05     	|  1              	|  1.6722e-05     	|  2.3964e-07     	|
|  [Callback]ModelCheckpoint{'monitor': 'val/f1', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_train_start                     	|  1.6453e-05     	|  1              	|  1.6453e-05     	|  2.3579e-07     	|
|  [LightningModule]BertGlobalPointer.on_save_checkpoint                                                                                                                                                         	|  1.9922e-06     	|  8              	|  1.5937e-05     	|  2.284e-07      	|
|  [Callback]EarlyStopping{'monitor': 'val/f1', 'mode': 'max'}.teardown                                                                                                                                          	|  1.5766e-05     	|  1              	|  1.5766e-05     	|  2.2594e-07     	|
|  [Callback]GradientAccumulationScheduler.on_fit_start                                                                                                                                                          	|  1.5168e-05     	|  1              	|  1.5168e-05     	|  2.1737e-07     	|
|  [Callback]EarlyStopping{'monitor': 'val/f1', 'mode': 'max'}.on_fit_end                                                                                                                                        	|  1.5071e-05     	|  1              	|  1.5071e-05     	|  2.1598e-07     	|
|  [Callback]RichModelSummary.on_pretrain_routine_start                                                                                                                                                          	|  1.4929e-05     	|  1              	|  1.4929e-05     	|  2.1395e-07     	|
|  [Callback]ModelCheckpoint{'monitor': 'val/f1', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_fit_start                       	|  1.4849e-05     	|  1              	|  1.4849e-05     	|  2.128e-07      	|
|  [Callback]ModelCheckpoint{'monitor': 'val/f1', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_pretrain_routine_start          	|  1.477e-05      	|  1              	|  1.477e-05      	|  2.1167e-07     	|
|  [Callback]RichModelSummary.on_train_start                                                                                                                                                                     	|  1.4742e-05     	|  1              	|  1.4742e-05     	|  2.1126e-07     	|
|  [Callback]EarlyStopping{'monitor': 'val/f1', 'mode': 'max'}.on_pretrain_routine_end                                                                                                                           	|  1.4386e-05     	|  1              	|  1.4386e-05     	|  2.0616e-07     	|
|  [Callback]RichModelSummary.on_pretrain_routine_end                                                                                                                                                            	|  1.4182e-05     	|  1              	|  1.4182e-05     	|  2.0324e-07     	|
|  [Callback]RichProgressBar.on_pretrain_routine_start                                                                                                                                                           	|  1.4093e-05     	|  1              	|  1.4093e-05     	|  2.0197e-07     	|
|  [Callback]ModelCheckpoint{'monitor': 'val/f1', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_pretrain_routine_end            	|  1.3913e-05     	|  1              	|  1.3913e-05     	|  1.9939e-07     	|
|  [Callback]RichProgressBar.on_pretrain_routine_end                                                                                                                                                             	|  1.3911e-05     	|  1              	|  1.3911e-05     	|  1.9936e-07     	|
|  [Callback]GradientAccumulationScheduler.on_pretrain_routine_end                                                                                                                                               	|  1.3876e-05     	|  1              	|  1.3876e-05     	|  1.9886e-07     	|
|  [Callback]GradientAccumulationScheduler.on_pretrain_routine_start                                                                                                                                             	|  1.3818e-05     	|  1              	|  1.3818e-05     	|  1.9802e-07     	|
|  [Callback]EarlyStopping{'monitor': 'val/f1', 'mode': 'max'}.on_train_end                                                                                                                                      	|  1.3616e-05     	|  1              	|  1.3616e-05     	|  1.9513e-07     	|
|  [LightningModule]BertGlobalPointer.configure_callbacks                                                                                                                                                        	|  1.304e-05      	|  1              	|  1.304e-05      	|  1.8688e-07     	|
|  [Callback]RichModelSummary.teardown                                                                                                                                                                           	|  1.1657e-05     	|  1              	|  1.1657e-05     	|  1.6706e-07     	|
|  [Callback]RichModelSummary.on_train_end                                                                                                                                                                       	|  1.1153e-05     	|  1              	|  1.1153e-05     	|  1.5983e-07     	|
|  [Callback]ModelCheckpoint{'monitor': 'val/f1', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_train_end                       	|  1.1056e-05     	|  1              	|  1.1056e-05     	|  1.5844e-07     	|
|  [Callback]RichModelSummary.on_fit_end                                                                                                                                                                         	|  1.0811e-05     	|  1              	|  1.0811e-05     	|  1.5493e-07     	|
|  [Callback]RichProgressBar.on_fit_end                                                                                                                                                                          	|  1.0705e-05     	|  1              	|  1.0705e-05     	|  1.5341e-07     	|
|  [Callback]GradientAccumulationScheduler.on_fit_end                                                                                                                                                            	|  1.0662e-05     	|  1              	|  1.0662e-05     	|  1.528e-07      	|
|  [Callback]ModelCheckpoint{'monitor': 'val/f1', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_fit_end                         	|  1.0467e-05     	|  1              	|  1.0467e-05     	|  1.5e-07        	|
|  [Callback]RichProgressBar.on_train_end                                                                                                                                                                        	|  1.0267e-05     	|  1              	|  1.0267e-05     	|  1.4713e-07     	|
|  [Callback]GradientAccumulationScheduler.on_train_end                                                                                                                                                          	|  1.0169e-05     	|  1              	|  1.0169e-05     	|  1.4573e-07     	|
|  [Callback]RichModelSummary.setup                                                                                                                                                                              	|  1.0076e-05     	|  1              	|  1.0076e-05     	|  1.444e-07      	|
|  [LightningModule]BertGlobalPointer.setup                                                                                                                                                                      	|  6.9819e-06     	|  1              	|  6.9819e-06     	|  1.0006e-07     	|
|  [Callback]EarlyStopping{'monitor': 'val/f1', 'mode': 'max'}.on_before_accelerator_backend_setup                                                                                                               	|  6.058e-06      	|  1              	|  6.058e-06      	|  8.6817e-08     	|
|  [LightningModule]BertGlobalPointer.on_fit_start                                                                                                                                                               	|  5.8149e-06     	|  1              	|  5.8149e-06     	|  8.3333e-08     	|
|  [Callback]EarlyStopping{'monitor': 'val/f1', 'mode': 'max'}.on_configure_sharded_model                                                                                                                        	|  5.4231e-06     	|  1              	|  5.4231e-06     	|  7.7718e-08     	|
|  [Callback]ModelCheckpoint{'monitor': 'val/f1', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.teardown                           	|  5.0198e-06     	|  1              	|  5.0198e-06     	|  7.1939e-08     	|
|  [Callback]GradientAccumulationScheduler.setup                                                                                                                                                                 	|  4.8771e-06     	|  1              	|  4.8771e-06     	|  6.9893e-08     	|
|  [Callback]RichModelSummary.on_configure_sharded_model                                                                                                                                                         	|  4.8641e-06     	|  1              	|  4.8641e-06     	|  6.9706e-08     	|
|  [Callback]ModelCheckpoint{'monitor': 'val/f1', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': True}.on_configure_sharded_model         	|  4.845e-06      	|  1              	|  4.845e-06      	|  6.9433e-08     	|
|  [Callback]ModelCheckpoint{'monitor': 'val/f1', 'mode': 'max', 'every_n_train_steps': 0, 'every_n_epochs': 1, 'train_time_interval': None, 'save_on_train_epoch_end': None}.on_before_accelerator_backend_setup	|  4.7062e-06     	|  1              	|  4.7062e-06     	|  6.7444e-08     	|
|  [Callback]RichModelSummary.on_before_accelerator_backend_setup                                                                                                                                                	|  4.5269e-06     	|  1              	|  4.5269e-06     	|  6.4875e-08     	|
|  [Callback]GradientAccumulationScheduler.on_configure_sharded_model                                                                                                                                            	|  4.5018e-06     	|  1              	|  4.5018e-06     	|  6.4515e-08     	|
|  [Callback]RichProgressBar.on_configure_sharded_model                                                                                                                                                          	|  4.4738e-06     	|  1              	|  4.4738e-06     	|  6.4114e-08     	|
|  [Callback]GradientAccumulationScheduler.on_before_accelerator_backend_setup                                                                                                                                   	|  4.451e-06      	|  1              	|  4.451e-06      	|  6.3787e-08     	|
|  [Callback]RichProgressBar.on_before_accelerator_backend_setup                                                                                                                                                 	|  4.295e-06      	|  1              	|  4.295e-06      	|  6.1552e-08     	|
|  [LightningModule]BertGlobalPointer.on_fit_end                                                                                                                                                                 	|  3.9989e-06     	|  1              	|  3.9989e-06     	|  5.7307e-08     	|
|  [LightningModule]BertGlobalPointer.on_pretrain_routine_start                                                                                                                                                  	|  3.943e-06      	|  1              	|  3.943e-06      	|  5.6507e-08     	|
|  [LightningModule]BertGlobalPointer.on_val_dataloader                                                                                                                                                          	|  3.119e-06      	|  1              	|  3.119e-06      	|  4.4698e-08     	|
|  [LightningModule]BertGlobalPointer.on_train_dataloader                                                                                                                                                        	|  2.9351e-06     	|  1              	|  2.9351e-06     	|  4.2062e-08     	|
|  [LightningModule]BertGlobalPointer.prepare_data                                                                                                                                                               	|  2.7551e-06     	|  1              	|  2.7551e-06     	|  3.9483e-08     	|
|  [Strategy]DDPStrategy.on_train_start                                                                                                                                                                          	|  2.5341e-06     	|  1              	|  2.5341e-06     	|  3.6316e-08     	|
|  [LightningModule]BertGlobalPointer.configure_sharded_model                                                                                                                                                    	|  2.2738e-06     	|  1              	|  2.2738e-06     	|  3.2586e-08     	|
|  [LightningModule]BertGlobalPointer.on_pretrain_routine_end                                                                                                                                                    	|  2.203e-06      	|  1              	|  2.203e-06      	|  3.1572e-08     	|
|  [LightningModule]BertGlobalPointer.teardown                                                                                                                                                                   	|  1.9171e-06     	|  1              	|  1.9171e-06     	|  2.7474e-08     	|
|  [LightningModule]BertGlobalPointer.on_train_end                                                                                                                                                               	|  1.7851e-06     	|  1              	|  1.7851e-06     	|  2.5582e-08     	|
|  [Strategy]DDPStrategy.on_train_end                                                                                                                                                                            	|  1.522e-06      	|  1              	|  1.522e-06      	|  2.1812e-08     	|
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------

[[36m2022-06-01 18:48:56,892[0m][[34mnlhappy.run[0m][[32mINFO[0m] - Finalizing![0m
[[36m2022-06-01 18:48:56,893[0m][[34mnlhappy.run[0m][[32mINFO[0m] - Best model ckpt at /root/nlhappy/logs/experiments/CMeEE/runs/2022-06-01/16-52-26/checkpoints/epoch12_0.647.ckpt[0m
